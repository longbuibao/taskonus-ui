<%- include('partials/detailtaskHeader.ejs') %>
    <div class="notion-app">
        <!-- beign control -->
        <div class="control">
            <!-- account -->
            <div class="i-user">
                <img class="thumb" src="data:image/png;base64,<%= finalAvatar %>" />
                <div class="u-name">
                    <a href="http://localhost:3000/users/me">
                        <%= username %>
                    </a>
                </div>
            </div>
            <!-- search-filter -->
            <div class="se-fi">
                <div class="form-group">
                    <div class="btn-group">
                        <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="Tìm kiếm nhanh">
                        <div class="btn btn-info">Tìm</div>
                    </div>
                </div>

                <div class="form-group">
                    <select class="custom-select" required>
                <option selected>Thứ tự mặc định</option>
                <option value="1">Nhiệm vụ đã hoàn thành</option>
                <option value="2">Thứ tự từ cũ đến mới</option>
                <option value="3">Thứ tự từ mới đến cũ</option>
            </select>
                </div>
            </div>
            <!-- favorite -->
            <div class="favorite">
                <i class="fa fa-star"></i>
                <h5>Yêu thích</h5>
            </div>

            <!-- board -->
            <div class="board">
                <i class="fa fa-clipboard-list"></i>
                <h5>
                    <a href="http://localhost:3000/my-tasks">Bảng của tôi</a>
                </h5>
                <i class="fa fa-addtask fa-plus" data-toggle="modal" data-target="#board"></i>
            </div>
            <div>
                <% boardAndCollection.boardName.forEach(name => { %>
                    <a style="text-align: center; margin: 10px; display: block;" href="/my-tasks-by/?boardName=<%=name%>">
                        <%= name %>
                    </a>
                    <% }) %>
            </div>
        </div>


        <!-- begin-detail -->
        <div class="detail">
            <div style="position: absolute; right: 0; padding: 20px; min-width: fit-content;">
                <button>
                    <a href="/users/logoutall">Đăng xuất tất cả các phiên</a>
                </button>
                <button>
                    <a href="/users/logout">Đăng xuất</a>
                </button>
            </div>
            <div class="overlay" style="display: none; position: fixed; top:0; right: 0; left: 0; bottom: 0; background-color:rgba(255,255,255,0); z-index: 0;"></div>

            <!--Đầu trang kế hoạch thiết kế-->
            <div class="kehoachthietke">

                <div>
                    <h2>
                        <%= data.boardName %>
                    </h2>
                    <p>
                        Ngày tạo:
                        <%= time %>
                    </p>
                </div>

            </div>
            <!--Nội dung kế hoach thiết kế-->
            <div class="noi-dung-ke-hoach-thiet-ke">
                <% for (const collectionName in data.tasksFrom) { %>
                    <div class="thu-muc">
                        <!--thư mục-->
                        <div class="style-button" style="position: relative; z-index: 1000;">
                            <div class="button">
                                <%= collectionName %>
                            </div>
                            <p class="icon">
                                <p class="fix-icon"> <i class="far fa-edit"></i> </p>
                                <p class="fix-icon-add"> <i class="far fa-trash-alt"></i> </p>
                            </p>
                            <!-- popup mục cần làm -->
                            <div class="popup-can-lam" style="display: none; background-color: antiquewhite; position:absolute; top: 30px; right: -45px; margin:5px; padding: 10px; z-index: 1111;">
                                <p style="border-bottom: 1px solid rgba(0,0,0,0.4); padding: 5px;"> <i class="fas fa-plus-circle"></i> Xóa</p>
                                <p style="border-bottom: 1px solid rgba(0,0,0,0.4); padding: 5px;"> <i class="fas fa-plus-circle"></i> Đổi tên</p>
                            </div>
                        </div>
                        <div class="tien-do-ke-hoach">
                            <!--tiến độ kế hoạch-->
                            <% data.tasksFrom[collectionName].forEach(task => {%>
                                <div class="muc-ke-hoach">
                                    <!--mục kế hoạch của mục Làm ĐN-ĐK-->
                                    <div class="style-trang-gioi-thieu">
                                        <h5>
                                            <%= task %>
                                        </h5>
                                        <div class="fas-fa-ellipsis-h"> <i class="fas fa-check"></i> <i class="far fa-edit"></i> <i class="far fa-trash-alt"></i> </div>
                                    </div>
                                    <div class="far-fa-comment-alt"> <i class="far fa-comment-alt"></i> </div>
                                </div>
                                <% }) %>
                        </div>

                    </div>
                    <% } %>
            </div>
        </div>
        <div class="modal fade" id="board" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Tạo bảng mới</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                    </div>
                    <div class="modal-body">
                        <!-- input form -->
                        <form action="/tasks/create" method="POST">
                            <div class="form-group">
                                <label for="name">Tên bảng</label>
                                <input type="text" name="boardName" class="form-control" placeholder="Nhập tên bảng">
                            </div>
                            <div class="form-group">
                                <label for="name">Tên thư mục</label>
                                <input type="text" name="collectionName" class="form-control" placeholder="Nhập nhóm thư mục (đang làm,...)">
                            </div>
                            <div class="form-group">
                                <label for="name">Tên task</label>
                                <input type="text" name="description" class="form-control" placeholder="Nhập tên task của thư mục (công việc 1,...)">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
                                <button type="submit" class="btn btn-primary">Tạo</button>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>
        <!-- onclick-detail-board -->
        <%- include('partials/detailtaskFooter.ejs') %>